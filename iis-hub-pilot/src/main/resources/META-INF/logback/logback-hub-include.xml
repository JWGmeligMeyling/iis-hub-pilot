<?xml version="1.0" encoding="UTF-8"?>
<included
    debug="false"
    xmlns="ch.qos.logback">
    
    <statusListener class="ch.qos.logback.core.status.NopStatusListener"/>
    
    <contextListener class="ch.qos.logback.classic.jul.LevelChangePropagator">
        <resetJUL>true</resetJUL>
    </contextListener>
    
    <if condition='!isDefined("hub.log.dir") &amp;&amp; isDefined("catalina.base")'>
        <then>
            <property name="hub.log.dir" value="${catalina.base}/logs" scope="context"/>
        </then>
    </if>
    <if condition='!isDefined("hub.log.dir") &amp;&amp; isDefined("hub.webapp.dir")'>
        <then>
            <property name="hub.log.dir" value="${hub.webapp.dir}/WEB-INF/logs" scope="context"/>
        </then>
    </if>
    
    <property name="hub.log.file.name" value="${hub.log.file.name:-${CONTEXT_NAME}}" scope="context"/>
    <property name="hub.log.file.ext" value="${hub.log.file.ext:-.log}" scope="context"/>
    
    <appender name="console" class="ch.qos.logback.core.ConsoleAppender">
        <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
            <pattern>%p - %m%n%ex</pattern>
        </encoder>
        <target>System.err</target>
        <withJansi>true</withJansi>
    </appender>
    
    <if condition='isDefined("hub.log.dir") &amp;&amp; !new java.io.File(p("hub.log.dir")).isFile()'>
        <then>
            <appender name="file" class="ch.qos.logback.core.rolling.RollingFileAppender">
                <file>${hub.log.dir}/${hub.log.file.name}${hub.log.file.ext}</file>
                <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
                    <fileNamePattern>${hub.log.dir}/${hub.log.file.name}.%d{yyyy-MM-dd}.%i${hub.log.file.ext}</fileNamePattern>
                    <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
                        <maxFileSize>50MB</maxFileSize>
                    </timeBasedFileNamingAndTriggeringPolicy>
                </rollingPolicy>
                <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
                    <pattern>%d{yyyy-MM-dd HH:mm:ss z} [%C:%L %t] %p - %m%n%ex</pattern>
                </encoder>
            </appender>
        </then>
    </if>
    
    <logger name="gov.hhs.onc.iishubpilot" level="all" additivity="false">
        <appender-ref ref="console"/>
        <appender-ref ref="file"/>
    </logger>
    <logger name="org.apache" level="info" additivity="false">
        <appender-ref ref="console"/>
        <appender-ref ref="file"/>
    </logger>
    <logger name="org.hibernate" level="info" additivity="false">
        <appender-ref ref="console"/>
        <appender-ref ref="file"/>
    </logger>
    <logger name="org.hibernate.SQL" level="debug" additivity="false">
        <appender-ref ref="console"/>
        <appender-ref ref="file"/>
    </logger>
    <logger name="org.springframework" level="info" additivity="false">
        <appender-ref ref="console"/>
        <appender-ref ref="file"/>
    </logger>
    <root level="warn">
        <appender-ref ref="console"/>
        <appender-ref ref="file"/>
    </root>
</included>